<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë©´ì ‘ ì „í˜• ì•ˆë‚´ë¬¸ ìƒì„±ê¸°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dom-to-image/2.6.0/dom-to-image.min.js"></script>

    <style>
        /* Custom styles */
        body {
            font-family: 'Inter', sans-serif;
            /* bodyì˜ ê¸°ë³¸ ë°°ê²½ìƒ‰ì€ JSì—ì„œ ë™ì ìœ¼ë¡œ ì²˜ë¦¬ */
        }
        .ì•ˆë‚´ë¬¸-ì œëª© {
            font-size: 1.8em;
            font-weight: 600;
            color: #1e293b;
        }
        .ì•ˆë‚´ë¬¸-ë³¸ë¬¸ {
            font-size: 1.1rem;
            line-height: 1.75rem;
            color: #070707; /* ê¸°ë³¸ í…ìŠ¤íŠ¸ ìƒ‰ìƒ */
        }
        .ì•ˆë‚´ë¬¸-ê°•ì¡° {
            font-weight: 600;
            color: #1e293b;
        }
        .ì•ˆë‚´ë¬¸-êµ¬ë¶„ì„  {
            border-top-width: 1px;
            border-color: #e5e7eb;
            margin-top: 2rem;
            margin-bottom: 2rem;
        }
        .blue-text {
            color: #0000FF; /* ê¸°ì¡´ íŒŒë€ìƒ‰ í…ìŠ¤íŠ¸ ìœ ì§€ */
        }

        /* ì¶”ê°€ëœ ìŠ¤íƒ€ì¼ */
        .form-section {
            border-top: 1px solid #e5e7eb;
            padding-top: 1.5rem;
            margin-top: 1.5rem;
        }

         /* ê°„ë‹¨í•œ í…ìŠ¤íŠ¸ ì—ë””í„° ìŠ¤íƒ€ì¼ */
        .text-editor {
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            min-height: 150px;
            padding: 0.5rem 0.75rem;
            outline: none;
            background-color: #fff;
            overflow-y: auto;
            text-align: left; /* ê¸°ë³¸ ì •ë ¬ */
        }
         .editor-toolbar {
            display: flex;
            flex-wrap: wrap; /* ëª¨ë°”ì¼ì—ì„œ ì¤„ë°”ê¿ˆ */
            gap: 0.5rem; /* ë²„íŠ¼ ê°„ ê°„ê²© */
            margin-top: 0.25rem;
            margin-bottom: 0.25rem;
            padding: 0.5rem;
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            background-color: #f9fafb;
        }
         .editor-toolbar button, .editor-toolbar select, .editor-toolbar input[type="color"] { /* ìƒ‰ìƒ ì…ë ¥ í•„ë“œ ìŠ¤íƒ€ì¼ ì¶”ê°€ */
            padding: 0.25rem 0.5rem;
            border: 1px solid #d1d5db;
            border-radius: 0.25rem;
            background-color: #f3f4f6;
            cursor: pointer;
            font-size: 0.875rem; /* ì‘ì€ í°íŠ¸ */
        }
        .editor-toolbar button:hover, .editor-toolbar select:hover, .editor-toolbar input[type="color"]:hover { /* ìƒ‰ìƒ ì…ë ¥ í•„ë“œ í˜¸ë²„ ìŠ¤íƒ€ì¼ ì¶”ê°€ */
            background-color: #e5e7eb;
        }
        .editor-toolbar select {
             padding-right: 1.5rem; /* ë“œë¡­ë‹¤ìš´ í™”ì‚´í‘œ ê³µê°„ */
             -webkit-appearance: none; /* ê¸°ë³¸ í™”ì‚´í‘œ ì œê±° */
             -moz-appearance: none;
             appearance: none;
             background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.362%22%20height%3D%22292.362%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M287.9%20139.8H4.5c-3.9%200-7.5%201.4-10.3%204.2-2.8%202.8-4.2%206.4-4.2%2010.3s1.4%207.5%204.2%2010.3l139.2%20139.2c2.8%202.8%206.4%204.2%2010.3%204.2s7.5-1.4%2010.3-4.2l139.2-139.2c2.8-2.8%204.2-6.4%204.2-10.3s-1.4-7.5-4.2-10.3z%22%2F%3E%3C%2Fsvg%3E');
             background-repeat: no-repeat;
             background-position: right 0.5rem center;
             background-size: 0.6em auto;
        }
         /* ìƒ‰ìƒ ì…ë ¥ í•„ë“œì˜ ì‹¤ì œ ìƒ‰ìƒ í‘œì‹œ ì˜ì—­ í¬ê¸° ì¡°ì • */
        .editor-toolbar input[type="color"] {
            width: 40px; /* ë„ˆë¹„ ì¡°ì • */
            padding: 0.1rem; /* ë‚´ë¶€ íŒ¨ë”© ì¡°ì • */
        }


        /* Custom list style for preview area */
        .apply-list-style {
            list-style-type: disc;
            padding-left: 1.5em; /* Adjust as needed for spacing */
        }
         .apply-list-style p { /* Apply list style to paragraphs within the list container */
            display: list-item;
            margin-bottom: 0.5em; /* Space between list items */
        }

         /* Tailwind alignment classes for preview area */
        .text-left { text-align: left; }
        .text-center { text-align: center; }
        .text-right { text-align: right; }

         /* Tailwind font size classes for preview area */
        .text-sm { font-size: 0.875rem; }
        .text-base { font-size: 1rem; }
        .text-lg { font-size: 1.125rem; }
        .text-xl { font-size: 1.25rem; }
        .text-2xl { font-size: 1.5rem; }

        /* ì•ˆë‚´ë¬¸ ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° í¬ê¸° ì œí•œ */
        #mainImage {
            max-width: 100%; /* ë¶€ëª¨ ìš”ì†Œ ë„ˆë¹„ì— ë§ì¶¤ */
            max-height: 500px; /* ìµœëŒ€ ë†’ì´ ìœ ì§€ */
            height: auto; /* ë¹„ìœ¨ ìœ ì§€ */
            object-fit: contain; /* ì´ë¯¸ì§€ê°€ ì˜ë¦¬ì§€ ì•Šê³  ë³´ì´ë„ë¡ */
             margin-bottom: 1.5rem; /* ì´ë¯¸ì§€ ì•„ë˜ ê°„ê²© ìœ ì§€ */
        }

         /* ë¯¸ë¦¬ë³´ê¸° ì˜ì—­ ë‚´ ìš”ì†Œ ê°„ ê°„ê²© ì¡°ì • */
        #basicTemplate > div,
        #basicTemplate > h2,
        #basicTemplate > p,
        #basicTemplate > .ì•ˆë‚´ë¬¸-êµ¬ë¶„ì„  {
            margin-bottom: 1rem; /* ê¸°ë³¸ ê°„ê²© */
        }

        #basicTemplate > .mb-4 { /* ê¸°ì¡´ mb-4 í´ë˜ìŠ¤ ìœ ì§€ (í•„ìš”ì‹œ) */
             margin-bottom: 1rem; /* mb-4ë¥¼ 1remìœ¼ë¡œ í†µì¼ */
        }

        /* ìº¡ì²˜ ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ - ì„¸ë¡œ ë ˆì´ì•„ì›ƒì„ ìœ„í•œ ê³ ì • ë„ˆë¹„ ì ìš© */
        #captureContainer {
             position: absolute;
             top: -9999px;
             left: -9999px;
             background-color: #ffffff;
             padding: 20px; /* íŒ¨ë”© ìœ ì§€ */
             box-sizing: border-box;
             /* ìº¡ì²˜ ì‹œ ì„¸ë¡œ ë ˆì´ì•„ì›ƒì„ ìœ„í•´ ë„ˆë¹„ë¥¼ ê³ ì • */
             width: 600px; /* ì›í•˜ëŠ” ì„¸ë¡œ ë ˆì´ì•„ì›ƒ ë„ˆë¹„ (ì¡°ì • ê°€ëŠ¥) */
             max-width: 100%;
             /* border: 1px solid #a0a0a0; /* í…Œë‘ë¦¬ ì œê±° */
             border-radius: 0.5rem; /* í…Œë‘ë¦¬ ëª¨ì„œë¦¬ ë‘¥ê¸€ê²Œ */
        }

        /* ë©”ì‹œì§€ í‘œì‹œ ì˜ì—­ ìŠ¤íƒ€ì¼ */
        #messageArea {
            margin-top: 1rem;
            padding: 0.75rem;
            border-radius: 0.375rem;
            font-size: 0.875rem;
            min-height: 1.5rem; /* ìµœì†Œ ë†’ì´ ì„¤ì • */
        }
        .message-success {
            background-color: #d1fae5; /* green-100 */
            color: #065f46; /* green-800 */
            border: 1px solid #34d399; /* green-400 */
        }
        .message-error {
            background-color: #fee2e2; /* red-100 */
            color: #991b1b; /* red-800 */
            border: 1px solid #f87171; /* red-400 */
        }
        .message-info {
            background-color: #e0f2f7; /* cyan-100 */
            color: #0e7490; /* cyan-800 */
            border: 1px solid #22d3ee; /* cyan-400 */
        }


        /* ë°˜ì‘í˜• ë””ìì¸ì„ ìœ„í•œ ì¡°ì • */
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
                padding: 1rem; /* ëª¨ë°”ì¼ íŒ¨ë”© ê°ì†Œ */
            }
            .w-full.lg\:w-1\/3, .w-full.lg\:w-2\/3 { /* ëª¨ë°”ì¼ì—ì„œëŠ” ì „ì²´ ë„ˆë¹„ ì‚¬ìš© */
                width: 100%;
            }
            .ì•ˆë‚´ë¬¸-ì œëª© {
                font-size: 1.4em;
            }
            .ì•ˆë‚´ë¬¸-ë³¸ë¬¸ {
                font-size: 1rem;
                line-height: 1.5rem;
            }
             .p-6.sm\:p-8 { /* ë¯¸ë¦¬ë³´ê¸° ì˜ì—­ íŒ¨ë”© ì¡°ì • */
                 padding: 1.5rem;
             }
             .space-y-4 > :not([hidden]) ~ :not([hidden]),
             .space-y-6 > :not([hidden]) ~ :not([hidden]) { /* ì„¸ë¡œ ê°„ê²© ì¡°ì • */
                 margin-top: 1rem;
             }
             .gap-6.lg\:gap-8 { /* ê°€ë¡œ ê°„ê²© ì¡°ì • */
                 gap: 1.5rem;
             }
             #mainImage {
                 max-height: 450px; /* ëª¨ë°”ì¼ì—ì„œ ì´ë¯¸ì§€ ìµœëŒ€ ë†’ì´ ìœ ì§€ */
                 margin-bottom: 1rem; /* ëª¨ë°”ì¼ ì´ë¯¸ì§€ ì•„ë˜ ê°„ê²© ì¡°ì • */
             }
             #basicTemplate > div,
             #basicTemplate > h2,
             #basicTemplate > p,
             #basicTemplate > .ì•ˆë‚´ë¬¸-êµ¬ë¶„ì„  {
                 margin-bottom: 0.75rem; /* ëª¨ë°”ì¼ ê¸°ë³¸ ê°„ê²© ê°ì†Œ */
             }
             #captureContainer {
                 padding: 25px; /* ëª¨ë°”ì¼ ìº¡ì²˜ íŒ¨ë”© ìœ ì§€ */
                 width: 100%; /* ëª¨ë°”ì¼ì—ì„œëŠ” ìº¡ì²˜ ë„ˆë¹„ë„ 100%ë¡œ */
             }
        }

    </style>
</head>
<body class="bg-gray-100 p-4 sm:p-8">
    <div class="container mx-auto bg-white rounded-lg shadow-md p-6 sm:p-8 flex flex-col lg:flex-row gap-6 lg:gap-8">
        <div class="w-full lg:w-1/3 space-y-6"> <h1 class="text-xl sm:text-2xl font-semibold text-gray-800 mb-6">ë©´ì ‘ ì •ë³´ ì…ë ¥</h1>

            <div class="form-section space-y-4"> <h2 class="text-lg font-semibold text-gray-700">ì´ë¯¸ì§€ ì—…ë¡œë“œ</h2>
                 <div>
                     <label for="companyLogo" class="block text-sm font-medium text-gray-700 mb-1">íšŒì‚¬ ë¡œê³ </label> <input type="file" id="companyLogo" accept="image/*" class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"> </div>
                 <div>
                     <label for="companyMainImage" class="block text-sm font-medium text-gray-700 mb-1">ì•ˆë‚´ë¬¸ ì´ë¯¸ì§€ (ì„ íƒ ì‚¬í•­)</label> <input type="file" id="companyMainImage" accept="image/*" class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"> </div>
            </div>

            <div class="form-section space-y-4"> <h2 class="text-lg font-semibold text-gray-700">ê¸°ë³¸ ì •ë³´</h2>
                 <div class="flex flex-col sm:flex-row gap-4"> <div class="flex-1"> <label for="applicantName" class="block text-sm font-medium text-gray-700 mb-1">ì§€ì›ì ì´ë¦„</label>
                         <input type="text" id="applicantName" class="mt-1 p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm w-full">
                     </div>
                     <div class="flex-1"> <label for="teamName" class="block text-sm font-medium text-gray-700 mb-1">ì§€ì›íŒ€</label>
                         <input type="text" id="teamName" class="mt-1 p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm w-full">
                     </div>
                 </div>
                 <div>
                     <label for="interviewProcess" class="block text-sm font-medium text-gray-700 mb-1">ë©´ì ‘ ì ˆì°¨</label> <select id="interviewProcess" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm">
                         <option value="ì„œë¥˜ í•©ê²©">ì„œë¥˜ í•©ê²© â†’ 1ì°¨ ë©´ì ‘</option>
                         <option value="1ì°¨ ë©´ì ‘">1ì°¨ ë©´ì ‘ â†’ 2ì°¨ ë©´ì ‘</option>
                         <option value="ìµœì¢… í•©ê²©">ìµœì¢… í•©ê²©</option>
                         <option value="ìµœì¢… ë¶ˆí•©ê²©">ìµœì¢… ë¶ˆí•©ê²©</option>
                     </select>
                 </div>
            </div>

            <div class="form-section space-y-4"> <h2 class="text-lg font-semibold text-gray-700">ë©´ì ‘ ìƒì„¸</h2>
                 <div> <label for="interviewDate" class="block text-sm font-medium text-gray-700 mb-1">ë©´ì ‘ ì¼ì‹œ</label>
                     <input type="datetime-local" id="interviewDate" class="mt-1 p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm w-full">
                 </div>
                 <div> <label for="interviewLocation" class="block text-sm font-medium text-gray-700 mb-1">ë©´ì ‘ ì¥ì†Œ</label>
                     <input type="text" id="interviewLocation" class="mt-1 p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm w-full">
                 </div>
                 <div> <label for="interviewDressCode" class="block text-sm font-medium text-gray-700 mb-1">ë©´ì ‘ ë³µì¥</label>
                     <input type="text" id="interviewDressCode" class="mt-1 p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm w-full">
                 </div>
                 <div> <label for="interviewProgress" class="block text-sm font-medium text-gray-700 mb-1">ë©´ì ‘ ë°©ì‹</label>
                     <input type="text" id="interviewProgress" class="mt-1 p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm w-full">
                 </div>
            </div>

            <div class="form-section space-y-4"> <h2 class="text-lg font-semibold text-gray-700">ì¶”ê°€ ì•ˆë‚´ ë° ê¸°íƒ€ ì‚¬í•­</h2>
                 <div>
                     <label for="additionalInfoType" class="block text-sm font-medium text-gray-700 mb-1">ì¶”ê°€ ì•ˆë‚´ ì‚¬í•­ ì„ íƒ</label> <select id="additionalInfoType" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm">
                         <option value="ë‹´ë‹¹ì ë¬¸ì˜">ë‹´ë‹¹ì ë¬¸ì˜</option>
                         <option value="ê³µì¥ ë‹´ë‹¹ì ë¬¸ì˜">ê³µì¥ ë‹´ë‹¹ì ë¬¸ì˜</option>
                          <option value="ì—†ìŒ">ì—†ìŒ</option> </select>
                 </div>
                 <div class="flex flex-col sm:flex-row gap-4"> <div class="flex-1"> <label for="contactEmail" class="block text-sm font-medium text-gray-700 mb-1">ë‹´ë‹¹ì ì´ë©”ì¼</label>
                         <input type="text" id="contactEmail" class="mt-1 p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm w-full">
                     </div>
                     <div class="flex-1"> <label for="factoryContactInfo" class="block text-sm font-medium text-gray-700 mb-1">ê³µì¥ ë‹´ë‹¹ì ì •ë³´</label>
                         <input type="text" id="factoryContactInfo" class="mt-1 p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm w-full">
                     </div>
                 </div>

                 <div>
                     <label for="additionalInfo" class="block text-sm font-medium text-gray-700 mb-1">ê¸°íƒ€ ì‚¬í•­</label> <div class="editor-toolbar mb-1"> <button type="button" onclick="formatText('bold')" title="Bold" class="hover:bg-gray-200 px-2 py-1 rounded"><b>B</b></button> <button type="button" onclick="formatText('italic')" title="Italic" class="hover:bg-gray-200 px-2 py-1 rounded"><i>I</i></button> <button type="button" onclick="formatText('underline')" title="Underline" class="hover:bg-gray-200 px-2 py-1 rounded"><u>U</u></button> <button type="button" onclick="formatText('justifyLeft')" title="Align Left" class="hover:bg-gray-200 px-2 py-1 rounded">Align Left</button> <button type="button" onclick="formatText('justifyCenter')" title="Align Center" class="hover:bg-gray-200 px-2 py-1 rounded">Align Center</button> <button type="button" onclick="formatText('justifyRight')" title="Align Right" class="hover:bg-gray-200 px-2 py-1 rounded">Align Right</button> <select onchange="formatText('fontSize', this.value); this.selectedIndex=0;" title="Font Size" class="hover:bg-gray-200 px-2 py-1 rounded text-sm"> <option value="" disabled selected>í¬ê¸°</option>
                             <option value="1">8pt</option>
                             <option value="2">10pt</option>
                             <option value="3">12pt</option>
                             <option value="4">14pt</option>
                             <option value="5">18pt</option>
                             <option value="6">24pt</option>
                             <option value="7">36pt</option>
                         </select>
                         <input type="color" onchange="formatText('foreColor', this.value); this.value='#000000';" title="Text Color" class="hover:bg-gray-200 rounded"> </div>
                     <div id="additionalInfoEditor" class="text-editor" contenteditable="true"></div> </div>
            </div>


            <div class="form-section space-y-4"> <h2 class="text-lg font-semibold text-gray-700">ë°ì´í„° ê´€ë¦¬</h2>
                 <div class="flex flex-wrap gap-2"> <button id="saveDataButton" class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-md shadow-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 transition duration-150 ease-in-out"> í˜„ì¬ ë°ì´í„° ì €ì¥
                     </button>
                     <button id="deleteDataButton" class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-md shadow-md focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50 transition duration-150 ease-in-out"> ì„ íƒëœ ë°ì´í„° ì‚­ì œ
                     </button>
                 </div>
                 <div>
                     <label for="savedDataSelect" class="block text-sm font-medium text-gray-700 mb-1">ì €ì¥ëœ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°</label> <select id="savedDataSelect" class="mt-1 block w-full p-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 text-sm">
                         <option value="">-- ì €ì¥ëœ ë°ì´í„° ì„ íƒ --</option>
                     </select>
                 </div>
                 <div class="flex flex-wrap gap-2"> <button id="loadDataButton" class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-md shadow-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 transition duration-150 ease-in-out flex-1 sm:flex-none"> ì„ íƒëœ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
                     </button>
                     <button id="resetFormButton" class="bg-gray-500 hover:bg-gray-600 text-white font-bold py-2 px-4 rounded-md shadow-md focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-opacity-50 transition duration-150 ease-in-out flex-1 sm:flex-none"> ì…ë ¥ ì´ˆê¸°í™”
                     </button>
                 </div>
            </div>

             <div class="form-section"> <h2 class="text-lg font-semibold text-gray-700">ìº¡ì²˜ ë° ì €ì¥</h2>
                 <div class="mt-4"> <button id="captureAndSave" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 transition duration-150 ease-in-out w-full text-lg"> ì•ˆë‚´ë¬¸ ìº¡ì²˜ ë° ì €ì¥ (PNG)
                     </button>
                 </div>
                 <div id="messageArea" class="mt-4"></div> </div>

        </div>

        <div class="w-full lg:w-2\/3">
            <div id="previewArea" class="bg-white rounded-lg shadow-md border border-gray-200 p-8 sm:p-10">
                 <div id="basicTemplate">
                     <div id="companyLogoPreview" class="flex justify-center mb-4">
                         <img id="logoImage" src="#" alt="íšŒì‚¬ ë¡œê³ " style="max-width: 150px; display: none;">
                     </div>
                     <div id="companyMainImagePreviewArea" class="flex justify-center mb-4">
                          <img id="mainImage" src="#" alt="ì•ˆë‚´ë¬¸ ì´ë¯¸ì§€" style="max-width: 100%; height: auto; display: none;">
                     </div>
                      <h2 id="annaemunTitle" class="ì•ˆë‚´ë¬¸-ì œëª© mb-4 text-center">ë©´ì ‘ ì „í˜• ì•ˆë‚´</h2>
                     <p id="applicantNamePreview" class="ì•ˆë‚´ë¬¸-ë³¸ë¬¸ text-left mb-4"><span class="font-semibold text-lg"></span>ë‹˜.</p>
                     <div id="greeting" class="ì•ˆë‚´ë¬¸-ë³¸ë¬¸ mb-4 text-gray-600"><span class="font-normal text-lg"></span></div>
                     <div id="interviewDetails" class="space-y-2">
                         <p class="ì•ˆë‚´ë¬¸-ë³¸ë¬¸"><span class="ì•ˆë‚´ë¬¸-ê°•ì¡° blue-text">ğŸ“… ì¼ì‹œ:</span> <span id="interviewDatePreview" class="font-semibold text-lg"></span></p>
                         <p class="ì•ˆë‚´ë¬¸-ë³¸ë¬¸"><span class="ì•ˆë‚´ë¬¸-ê°•ì¡° blue-text">ğŸ“ ì¥ì†Œ:</span> <span id="interviewLocationPreview" class="font-semibold text-lg"></span></p>
                         <p class="ì•ˆë‚´ë¬¸-ë³¸ë¬¸"><span class="ì•ˆë‚´ë¬¸-ê°•ì¡° blue-text">ğŸ‘” ë³µì¥:</span> <span id="interviewDressCodePreview" class="font-semibold text-lg"></span></p>
                         <p class="ì•ˆë‚´ë¬¸-ë³¸ë¬¸"><span class="ì•ˆë‚´ë¬¸-ê°•ì¡° blue-text">ğŸ¤µ ë°©ì‹:</span> <span id="interviewProgressPreview" class="font-semibold text-lg">ë¯¸ì •</span></p>
                     </div>
                     <div class="ì•ˆë‚´ë¬¸-êµ¬ë¶„ì„ "></div>
                     <div id="additionalInfoPreview" class="ì•ˆë‚´ë¬¸-ë³¸ë¬¸ whitespace-pre-line mb-4 text-gray-600"></div>
                 </div>
                 </div>
            </div>
        </div>
    <div id="captureContainer" style="position: absolute; top: -9999px; left: -9999px; background-color: #ffffff; padding: 20px; box-sizing: border-box; width: 600px; max-width: 100%;">
        </div>
    <script>
    // Get references to DOM elements
    const companyLogoInput = document.getElementById('companyLogo');
    const companyMainImageInput = document.getElementById('companyMainImage'); // ì•ˆë‚´ë¬¸ ì´ë¯¸ì§€ ì…ë ¥ í•„ë“œ
    const applicantNameInput = document.getElementById('applicantName');
    const teamNameInput = document.getElementById('teamName');
    const interviewDateInput = document.getElementById('interviewDate');
    const interviewLocationInput = document.getElementById('interviewLocation');
    const interviewDressCodeInput = document.getElementById('interviewDressCode');
    const interviewProcessInput = document.getElementById('interviewProcess');
    const additionalInfoTypeInput = document.getElementById('additionalInfoType');
    const contactEmailInput = document.getElementById('contactEmail');
    const factoryContactInfoInput = document.getElementById('factoryContactInfo');
    const additionalInfoEditor = document.getElementById('additionalInfoEditor'); // í…ìŠ¤íŠ¸ ì—ë””í„° ìš”ì†Œ
    const captureAndSaveButton = document.getElementById('captureAndSave');
    const interviewProgressInput = document.getElementById('interviewProgress');
    // const predefinedTextSelect = document.getElementById('predefinedTextSelect'); // ê¸°ë³¸ ë¬¸êµ¬ ì„ íƒ ë“œë¡­ë‹¤ìš´ (ì œê±°ë¨)
    // const captureFormatSelect = document.getElementById('captureFormat'); // ìº¡ì²˜ í˜•ì‹ ì„ íƒ ë“œë¡­ë‹¤ìš´ (ì œê±°ë¨)
    const resetFormButton = document.getElementById('resetFormButton'); // ì´ˆê¸°í™” ë²„íŠ¼


    const previewArea = document.getElementById('previewArea'); // ë¯¸ë¦¬ë³´ê¸° ì˜ì—­ (í™”ë©´ì— ë³´ì´ëŠ” ë¶€ë¶„)
    const basicTemplateDiv = document.getElementById('basicTemplate'); // ê¸°ë³¸ í…œí”Œë¦¿ div (ë¯¸ë¦¬ë³´ê¸° ë‚´ìš©)
    const captureContainer = document.getElementById('captureContainer'); // ìº¡ì²˜ë¥¼ ìœ„í•œ ì„ì‹œ ì»¨í…Œì´ë„ˆ
    const messageArea = document.getElementById('messageArea'); // ë©”ì‹œì§€ í‘œì‹œ ì˜ì—­

    // ë¯¸ë¦¬ë³´ê¸° ìš”ì†Œë“¤ (basicTemplateDiv ë‚´ì˜ ìš”ì†Œë“¤)
    const annaemunTitleElement = document.getElementById('annaemunTitle'); // ì•ˆë‚´ë¬¸ ì œëª© ìš”ì†Œ
    const logoImagePreview = document.getElementById('logoImage');
    const mainImagePreview = document.getElementById('mainImage'); // ì•ˆë‚´ë¬¸ ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸°
    const greetingPreview = document.getElementById('greeting');
    const applicantNamePreview = document.getElementById('applicantNamePreview');
    const interviewDatePreview = document.getElementById('interviewDatePreview');
    const interviewLocationPreview = document.getElementById('interviewLocationPreview');
    const interviewDressCodePreview = document.getElementById('interviewDressCodePreview');
    const interviewProgressPreview = document.getElementById('interviewProgressPreview');
    const additionalInfoPreview = document.getElementById('additionalInfoPreview');

    const bodyElement = document.body; // body ìš”ì†Œ ê°€ì ¸ì˜¤ê¸°

    // Save/Load elements
    const saveDataButton = document.getElementById('saveDataButton');
    const loadDataButton = document.getElementById('loadDataButton');
    const deleteDataButton = document.getElementById('deleteDataButton');
    const savedDataSelect = document.getElementById('savedDataSelect');

    const LOCAL_STORAGE_KEY = 'interviewAnnaemunDataList'; // Key for localStorage (Use a different key for list)

    // ê¸°ë³¸ ë¬¸êµ¬ ë°ì´í„° ì •ì˜ (ì‚¬ìš©ë˜ì§€ ì•Šì§€ë§Œ, í˜¹ì‹œ ëª¨ë¥¼ ì°¸ì¡°ë¥¼ ìœ„í•´ ë‚¨ê²¨ë‘ )
    const predefinedTexts = {
        prepare_docs: `ë©´ì ‘ ì‹œ ë‹¤ìŒ ì„œë¥˜ë¥¼ ì§€ì°¸í•´ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤:
â€¢ ìµœì¢… í•™ë ¥ ì¦ëª…ì„œ
â€¢ ê²½ë ¥ ì¦ëª…ì„œ (í•´ë‹¹ ì‹œ)
â€¢ ìê²©ì¦ ì‚¬ë³¸ (í•´ë‹¹ ì‹œ)`,
        parking_info: `ì£¼ì°¨ ê³µê°„ì´ í˜‘ì†Œí•˜ì˜¤ë‹ˆ ëŒ€ì¤‘êµí†µ ì´ìš©ì„ ê¶Œì¥í•©ë‹ˆë‹¤. ìê°€ìš© ì´ìš© ì‹œ ì¸ê·¼ ìœ ë£Œ ì£¼ì°¨ì¥ì„ ì´ìš©í•´ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.`,
        contact_info: `ê¸°íƒ€ ë¬¸ì˜ ì‚¬í•­ì€ [ë‹´ë‹¹ì ì´ë©”ì¼] ë˜ëŠ” [ë‹´ë‹¹ì ì—°ë½ì²˜]ë¡œ ë¬¸ì˜í•´ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.`
    };


    // ë©”ì‹œì§€ í‘œì‹œ í•¨ìˆ˜
    function displayMessage(message, type = 'info') {
        messageArea.textContent = message;
        messageArea.className = `mt-4 message-${type}`; // Remove previous classes and add new ones
         // Clear message after 5 seconds
         setTimeout(() => {
             messageArea.textContent = '';
             messageArea.className = 'mt-4'; // Reset classes
         }, 5000);
    }


    // í…ìŠ¤íŠ¸ ì—ë””í„° ê¸°ëŠ¥
    function formatText(command, value = null) {
        // execCommandë¥¼ ì‚¬ìš©í•˜ì—¬ í…ìŠ¤íŠ¸ ì—ë””í„°ì˜ ì„ íƒ ì˜ì—­ì— ì„œì‹ ì ìš©
        document.execCommand(command, false, value);
        additionalInfoEditor.focus(); // í¬ì»¤ìŠ¤ ìœ ì§€
        // ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸ëŠ” input ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆì—ì„œ ì²˜ë¦¬
    }

     // í…ìŠ¤íŠ¸ ì—ë””í„°ì— HTML ì‚½ì… í•¨ìˆ˜ (ê¸°ë³¸ ë¬¸êµ¬ ì„ íƒ ì œê±°ë¡œ ì¸í•´ ì‚¬ìš©ë˜ì§€ ì•ŠìŒ)
    /*
    function insertHtmlAtCaret(html) {
        const selection = window.getSelection();
        if (selection && selection.rangeCount > 0) {
            const range = selection.getRangeAt(0);
            range.deleteContents(); // í˜„ì¬ ì„ íƒ ì˜ì—­ ì‚­ì œ
            const el = document.createElement("div");
            el.innerHTML = html;
            let frag = document.createDocumentFragment(), node, lastNode;
            while ( (node = el.firstChild) ) {
                lastNode = frag.appendChild(node);
            }
            range.insertNode(frag);

            // ì‚½ì…ëœ ë‚´ìš© ë’¤ë¡œ ì»¤ì„œ ì´ë™
            if (lastNode) {
                range.setStartAfter(lastNode);
                range.collapse(true);
                selection.removeAllRanges();
                selection.addRange(range);
            }
        } else {
            // ì„ íƒ ì˜ì—­ì´ ì—†ìœ¼ë©´ ì—ë””í„° ëì— ì¶”ê°€
            additionalInfoEditor.innerHTML += html;
        }
        additionalInfoEditor.focus(); // í¬ì»¤ìŠ¤ ìœ ì§€
        updatePreview(); // ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
    }
    */


    // ì´ë¯¸ì§€ íŒŒì¼(File ê°ì²´)ì„ ë°›ì•„ì„œ ë¦¬ì‚¬ì´ì¦ˆëœ Data URLì„ ë°˜í™˜í•˜ëŠ” ë¹„ë™ê¸° í•¨ìˆ˜
    function resizeImage(file, maxWidth, maxHeight, quality = 0.7) {
        return new Promise((resolve, reject) => {
            const reader = new FileReader();
            reader.onload = (readerEvent) => {
                const img = new Image();
                img.onload = () => {
                    let width = img.width;
                    let height = img.height;

                    // ë¹„ìœ¨ ìœ ì§€í•˜ë©° ìµœëŒ€ í¬ê¸° ê³„ì‚°
                    if (width > height) {
                        if (width > maxWidth) {
                            height *= maxWidth / width;
                            width = maxWidth;
                        }
                    } else {
                        if (height > maxHeight) {
                            width *= maxHeight / height;
                            height = maxHeight;
                        }
                    }

                    const canvas = document.createElement('canvas');
                    canvas.width = width;
                    canvas.height = height;
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(img, 0, 0, width, height);

                    // Data URLë¡œ ë³€í™˜ (JPEG í˜•ì‹ìœ¼ë¡œ ì••ì¶•)
                    resolve(canvas.toDataURL('image/jpeg', quality));
                };
                img.onerror = (error) => {
                    reject(error);
                };
                img.src = readerEvent.target.result;
            };
            reader.onerror = (error) => {
                reject(error);
            };
            reader.readAsDataURL(file);
        });
    }


    // ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸ í•¨ìˆ˜
    async function updatePreview() { // ë¹„ë™ê¸° í•¨ìˆ˜ë¡œ ë³€ê²½
        const applicantName = applicantNameInput.value;
        const teamName = teamNameInput.value;
        const interviewProcess = interviewProcessInput.value;
        const additionalInfoType = additionalInfoTypeInput.value;
        const contactEmail = contactEmailInput.value;
        const factoryContactInfo = factoryContactInfoInput.value;
        const interviewDate = interviewDateInput.value;
        const interviewLocation = interviewLocationInput.value;
        const interviewDressCode = interviewDressCodeInput.value;
        const interviewProgress = interviewProgressInput.value;
        let additionalInfoHtml = additionalInfoEditor.innerHTML; // ì—ë””í„°ì˜ HTML ë‚´ìš© ê°€ì ¸ì˜¤ê¸°

        let greetingText = '';
        let showDetails = true;
        let annaemunTitle = 'ë©´ì ‘ ì „í˜• ì•ˆë‚´'; // ê¸°ë³¸ ì œëª©

        switch (interviewProcess) {
            case 'ì„œë¥˜ í•©ê²©':
                greetingText = `ì•ˆë…•í•˜ì„¸ìš”.<br> ${teamName} ì„œë¥˜ í•©ê²©ì„ ì§„ì‹¬ìœ¼ë¡œ ì¶•í•˜ ë“œë¦¬ë©°, 1ì°¨ ë©´ì ‘ ì „í˜• ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤.`;
                annaemunTitle = '1ì°¨ ë©´ì ‘ ì „í˜• ì•ˆë‚´'; // ì œëª© ë³€ê²½
                break;
            case '1ì°¨ ë©´ì ‘': // valueëŠ” ê·¸ëŒ€ë¡œ '1ì°¨ ë©´ì ‘' ì‚¬ìš©
                greetingText = `ì•ˆë…•í•˜ì„¸ìš”.<br> ${teamName} 1ì°¨ ë©´ì ‘ í•©ê²©ì„ ì§„ì‹¬ìœ¼ë¡œ ì¶•í•˜ ë“œë¦¬ë©°, 2ì°¨ ë©´ì ‘ ì „í˜• ì•ˆë‚´ë“œë¦½ë‹ˆë‹¤.`;
                annaemunTitle = '2ì°¨ ë©´ì ‘ ì „í˜• ì•ˆë‚´'; // ì œëª© ë³€ê²½
                break;
            case 'ìµœì¢… í•©ê²©':
                annaemunTitle = 'ìµœì¢… í•©ê²© ì„ ì§„ì‹¬ìœ¼ë¡œ ì¶•í•˜ ë“œë¦½ë‹ˆë‹¤! ğŸ‰'; // ì œëª© ë³€ê²½ ë° ì´ëª¨í‹°ì½˜ ì¶”ê°€
                greetingText = `ì•ˆë…•í•˜ì„¸ìš”. <br> ${teamName} ìµœì¢… í•©ê²©ì„ ì§„ì‹¬ìœ¼ë¡œ ì¶•í•˜ ë“œë¦½ë‹ˆë‹¤.<br>
                ì„ ë°œ ê³¼ì •ì„ í†µí•´ ê·€í•˜ì˜ ê²½í—˜ê³¼ ìì§ˆì´ ìš°ë¦¬ ì´ëˆ„ìŠ¤ì˜ ë°œì „ ë°©í–¥ì— í° ê¸°ì—¬ë¥¼ í•  ê²ƒì´ë¼ê³  ë¯¿ìŠµë‹ˆë‹¤.
                <br><br>ë‹¤ìŒ ë‹¨ê³„ë¡œ ì¸ì‚¬íŒ€ì—ì„œ ì²˜ìš° ë° ì…ì‚¬ì¼ ì„ í¬í•¨í•œ ì„¸ë¶€ ì‚¬í•­ í˜‘ì˜ ë¥¼ ìœ„í•´ ì—°ë½ ë“œë¦´ ê²ƒ ì…ë‹ˆë‹¤.`;
                showDetails = false; // ë©´ì ‘ ìƒì„¸ ì •ë³´ ìˆ¨ê¹€
                break;
            case 'ìµœì¢… ë¶ˆí•©ê²©':
                 annaemunTitle = 'ì´ëˆ„ìŠ¤ ì¸ì¬ ëª¨ì§‘ ì§€ì›ì— ê°ì‚¬ ë“œë¦½ë‹ˆë‹¤.'; // ì œëª© ë³€ê²½
                greetingText = `ì•ˆë…•í•˜ì„¸ìš”.<br> ì´ëˆ„ìŠ¤ ${teamName} ì¸ì¬ ì˜ì…ì— ê´€ì‹¬ì„ ê°–ê³  ì§€ì›í•´ ì£¼ì…”ì„œ ê°ì‚¬ë“œë¦½ë‹ˆë‹¤.
                <br>ì•ˆíƒ€ê¹ê²Œë„ ë©´ì ‘ ì‹¬ì‚¬ì—ì„œ ì§€ì›ìë‹˜ì„ ì„ ë°œí•  ìˆ˜ ì—†ê²Œ ë˜ì—ˆìŒì„ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤.<br><br>
                ì´ëˆ„ìŠ¤ì— ëŒ€í•œ ê´€ì‹¬ê³¼ ì§€ì›ì— ê¹Šì€ ê°ì‚¬ë¥¼ ë“œë¦¬ë©°, ì•ë‚ ì— ë¬´ê¶í•œ ë°œì „ì´ í•¨ê»˜ í•˜ì‹œê¸°ë¥¼ ì§„ì‹¬ìœ¼ë¡œ ì§„ì‹¬ìœ¼ë¡œ ê¸°ì›ë“œë¦½ë‹ˆë‹¤.`;
                showDetails = false; // ë©´ì ‘ ìƒì„¸ ì •ë³´ ìˆ¨ê¹€
                break;
            default: // 2ì°¨ ë©´ì ‘ì´ ì‚­ì œë˜ì—ˆìœ¼ë¯€ë¡œ default ì²˜ë¦¬ì— í¬í•¨ë  ìˆ˜ ìˆìŒ
                greetingText = "";
                annaemunTitle = 'ë©´ì ‘ ì „í˜• ì•ˆë‚´'; // ê¸°ë³¸ ì œëª©
        }

        // ë¯¸ë¦¬ë³´ê¸° ìš”ì†Œë“¤ ì—…ë°ì´íŠ¸
        if (annaemunTitleElement) annaemunTitleElement.textContent = annaemunTitle; // ì•ˆë‚´ë¬¸ ì œëª© ì—…ë°ì´íŠ¸
        if (applicantNamePreview) applicantNamePreview.innerHTML = `<span class="font-semibold text-lg">${applicantName}</span>ë‹˜.`;
        // greetingPreviewì˜ <span> íƒœê·¸ì—ì„œ font-semibold í´ë˜ìŠ¤ ì œê±°
        if (greetingPreview) greetingPreview.innerHTML = `<span class="font-normal text-lg">${greetingText}</span>`;

        const interviewDetailsDiv = document.getElementById('interviewDetails'); // ê¸°ë³¸ í…œí”Œë¦¿ì˜ interviewDetails
        if (interviewDetailsDiv) {
            if (showDetails) {
                interviewDetailsDiv.style.display = 'block';
                if (interviewDatePreview) interviewDatePreview.textContent = interviewDate ? new Date(interviewDate).toLocaleString() : 'ë¯¸ì •';
                if (interviewLocationPreview) interviewLocationPreview.textContent = interviewLocation || 'ë¯¸ì •';
                if (interviewDressCodePreview) interviewDressCodePreview.textContent = interviewDressCode || 'ë¯¸ì •';
                if (interviewProgressPreview) interviewProgressPreview.textContent = interviewProgress || 'ë¯¸ì •';
            } else {
                interviewDetailsDiv.style.display = 'none';
            }
        }

        // --- URL ë° ì´ë©”ì¼ ìë™ ë§í¬ ë³€í™˜ ê¸°ëŠ¥ ì¶”ê°€ ---
        // ì—ë””í„°ì—ì„œ ê°€ì ¸ì˜¨ HTML ë‚´ìš©ì„ ë¨¼ì € ì²˜ë¦¬
        let processedAdditionalInfoHtml = additionalInfoHtml;

        // 1. URL ìë™ ë³€í™˜ (http, https, wwwë¡œ ì‹œì‘í•˜ëŠ” ê²½ìš°)
        // HTML íƒœê·¸ ë‚´ë¶€ì˜ URLì€ ì œì™¸í•˜ë„ë¡ ì •ê·œì‹ ê°œì„ 
        const urlRegex = /(?<!["'])((https?:\/\/\S+)|(www\.\S+))(?![>"'])/gi;
        processedAdditionalInfoHtml = processedAdditionalInfoHtml.replace(urlRegex, (match, p1, p2, p3) => {
            const url = p2 || p3; // capture group 2 (http/https) or 3 (www)
            const href = p2 ? url : `http://${url}`; // www.ë¡œ ì‹œì‘í•˜ë©´ http:// ë¶™ì—¬ì¤Œ
            return `<a href="${href}" target="_blank" rel="noopener noreferrer">${url}</a>`;
        });

        // 2. ì´ë©”ì¼ ì£¼ì†Œ ìë™ ë³€í™˜
        // HTML íƒœê·¸ ë‚´ë¶€ì˜ ì´ë©”ì¼ì€ ì œì™¸í•˜ë„ë¡ ì •ê·œì‹ ê°œì„ 
        const emailRegex = /(?<!["'>\w])([A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,})(?!["'<\w])/gi;
         processedAdditionalInfoHtml = processedAdditionalInfoHtml.replace(emailRegex, (match, email) => {
            return `<a href="mailto:${email}">${email}</a>`;
        });
        // --- ìë™ ë§í¬ ë³€í™˜ ë ---


        // additionalInfoPreviewì— ì²˜ë¦¬ëœ HTML ë‚´ìš©ì„ ë°˜ì˜
        additionalInfoPreview.innerHTML = processedAdditionalInfoHtml;


        // ì¶”ê°€ ì•ˆë‚´ ì‚¬í•­ íƒ€ì…ì— ë”°ë¥¸ ë‚´ìš© ì¶”ê°€ (ì²˜ë¦¬ëœ ì—ë””í„° ë‚´ìš© ë’¤ì— ë¶™ë„ë¡ ìˆ˜ì •)
        let appendedInfo = '';

        // 'ìµœì¢… ë¶ˆí•©ê²©' ì‹œì—ëŠ” ì¶”ê°€ ì•ˆë‚´ ì‚¬í•­ ë¬¸êµ¬ë¥¼ í‘œì‹œí•˜ì§€ ì•ŠìŒ
        if (interviewProcess !== 'ìµœì¢… ë¶ˆí•©ê²©') {
            // 'ìµœì¢… í•©ê²©' ì‹œì—ëŠ” 'ì†Œì¤‘í•œ ë§Œë‚¨' ë¬¸êµ¬ ì œì™¸, 'ê¸°íƒ€ ë¬¸ì˜' ë¬¸êµ¬ í¬í•¨
            if (interviewProcess === 'ìµœì¢… í•©ê²©') {
                 if (additionalInfoType === "ë‹´ë‹¹ì ë¬¸ì˜") {
                    appendedInfo = `<br><br>ê¸°íƒ€ ë¬¸ì˜ ì‚¬í•­ì€ ${contactEmail}ìœ¼ë¡œ ë¬¸ì˜í•´ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.<br><br>ê°ì‚¬í•©ë‹ˆë‹¤.<br><br>ì¸ì‚¬íŒ€ ì±„ìš© ë‹´ë‹¹ ë“œë¦¼`;
                 } else if (additionalInfoType === "ê³µì¥ ë‹´ë‹¹ì ë¬¸ì˜") {
                     appendedInfo = `<br><br>ê¸°íƒ€ ë¬¸ì˜ ì‚¬í•­ì€ ${contactEmail}ìœ¼ë¡œ ë¬¸ì˜í•´ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.<br><br>ê°ì‚¬í•©ë‹ˆë‹¤.<br><br>ê³µì¥ ë‹´ë‹¹ì : ${factoryContactInfo}`;
                 }
            } else { // 'ì„œë¥˜ í•©ê²©', '1ì°¨ ë©´ì ‘' ë“± ë©´ì ‘ ì§„í–‰ ìƒíƒœì¼ ë•Œ
                if (additionalInfoType === "ë‹´ë‹¹ì ë¬¸ì˜") {
                    // ìš”ì²­í•˜ì‹  ë¬¸êµ¬ ì‚½ì… ë° í•œ ì¤„ ë„ìš°ê¸° ë°˜ì˜
                    appendedInfo = `<br><br>ê¸°íƒ€ ë¬¸ì˜ ì‚¬í•­ì€ ${contactEmail}ìœ¼ë¡œ ë¬¸ì˜í•´ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.<br><br>${applicantName} ë‹˜ê³¼ì˜ ì†Œì¤‘í•œ ë§Œë‚¨ì„ ê¸°ëŒ€í•˜ë©°, ë©´ì ‘ ì¤€ë¹„ ì˜ í•˜ì‹œì–´ ì¢‹ì€ ê²°ê³¼ ìˆìœ¼ì‹œê¸°ë¥¼ ë°”ëë‹ˆë‹¤.<br><br>ê°ì‚¬í•©ë‹ˆë‹¤.<br><br>ì¸ì‚¬íŒ€ ì±„ìš© ë‹´ë‹¹ ë“œë¦¼`;
                } else if (additionalInfoType === "ê³µì¥ ë‹´ë‹¹ì ë¬¸ì˜") {
                     // ìš”ì²­í•˜ì‹  ë¬¸êµ¬ ì‚½ì… ë° í•œ ì¤„ ë„ìš°ê¸° ë°˜ì˜
                    appendedInfo = `<br><br>ê¸°íƒ€ ë¬¸ì˜ ì‚¬í•­ì€ ${contactEmail}ìœ¼ë¡œ ë¬¸ì˜í•´ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.<br><br>${applicantName} ë‹˜ê³¼ì˜ ì†Œì¤‘í•œ ë§Œë‚¨ì„ ê¸°ëŒ€í•˜ë©°, ë©´ì ‘ ì¤€ë¹„ ì˜ í•˜ì‹œì–´ ì¢‹ì€ ê²°ê³¼ ìˆìœ¼ì‹œê¸°ë¥¼ ë°”ëë‹ˆë‹¤.<br><br>ê°ì‚¬í•©ë‹ˆë‹¤.<br><br>ê³µì¥ ë‹´ë‹¹ì : ${factoryContactInfo}`;
                }
            }
        }


         // ê¸°íƒ€ ì‚¬í•­(ë§í¬ ë³€í™˜ í¬í•¨), ì¶”ê°€ ì•ˆë‚´ ì‚¬í•­, ë§ˆì§€ë§‰ ë¬¸êµ¬ë¥¼ ëª¨ë‘ í¬í•¨í•˜ëŠ” ìµœì¢… HTML êµ¬ì„±
         let fullAdditionalContent = processedAdditionalInfoHtml; // ì´ë¯¸ ì—ë””í„° ë‚´ìš© + ë§í¬ ë³€í™˜ ê²°ê³¼ê°€ ë“¤ì–´ìˆìŒ
         if (appendedInfo) {
             // ê¸°ì¡´ ë‚´ìš©ì´ ìˆê³  ì¶”ê°€ ë‚´ìš©ì´ ìˆìœ¼ë©´ ì¤„ë°”ê¿ˆ ì¶”ê°€
             if (fullAdditionalContent) {
                fullAdditionalContent += appendedInfo;
             } else {
                fullAdditionalContent = appendedInfo;
             }
         }

         // ì¶”ê°€ ë¬¸êµ¬ ì‚½ì… (ìµœì¢… ë¶ˆí•©ê²© ì‹œì—ë„ ì´ ë¬¸êµ¬ëŠ” í‘œì‹œ)
         const finalSignature = `ğŸ˜„ í•¨ê»˜í•˜ëŠ” ë§¤ ìˆœê°„ì´ ìœ ì¾Œí•œ ê²½í—˜ì´ ë˜ëŠ” ê³³, ë”ì´ëˆ„ìŠ¤`;
         if (fullAdditionalContent) { // ê¸°íƒ€ ì‚¬í•­/ì¶”ê°€ ì•ˆë‚´ ì‚¬í•­ ë‚´ìš©ì´ ìˆì„ ê²½ìš°ì—ë§Œ ë§ˆì§€ë§‰ ë¬¸êµ¬ ì•ì— ì¤„ë°”ê¿ˆ ì¶”ê°€
             fullAdditionalContent += `<br><br>${finalSignature}`;
         } else { // ë‚´ìš©ì´ ì—†ìœ¼ë©´ ë§ˆì§€ë§‰ ë¬¸êµ¬ë§Œ
             fullAdditionalContent = finalSignature;
         }


         // additionalInfoPreviewì— ìµœì¢… HTML ë‚´ìš©ì„ ì„¤ì •
         // additionalInfoPreview div ìì²´ì— text-gray-600 í´ë˜ìŠ¤ê°€ ìˆìœ¼ë¯€ë¡œ ë³„ë„ ë˜í•‘ ë¶ˆí•„ìš”
         additionalInfoPreview.innerHTML = fullAdditionalContent;


        // íšŒì‚¬ ë¡œê³  ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸ (ë¦¬ì‚¬ì´ì¦ˆ ì—†ìŒ)
        const logoFile = companyLogoInput.files[0];
        if (logoFile) {
            const reader = new FileReader();
            reader.onload = (e) => {
                logoImagePreview.src = e.target.result;
                logoImagePreview.style.display = 'block';
            };
            reader.readAsDataURL(logoFile);
        } else {
            logoImagePreview.style.display = 'none';
            logoImagePreview.src = '#';
        }

        // ì•ˆë‚´ë¬¸ ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸ (ë¦¬ì‚¬ì´ì¦ˆ ì—†ìŒ, CSSë¡œ í¬ê¸°ë§Œ ì¡°ì ˆ)
        const mainImageFile = companyMainImageInput.files[0];
        if (mainImageFile) {
            const reader = new FileReader();
            reader.onload = (e) => {
                mainImagePreview.src = e.target.result;
                mainImagePreview.style.display = 'block';
            };
            reader.readAsDataURL(mainImageFile);
        } else {
            mainImagePreview.style.display = 'none';
            mainImagePreview.src = '#';
        }
    }


    // ë°ì´í„° ì €ì¥ í•¨ìˆ˜ (ëª©ë¡ í˜•íƒœë¡œ ì €ì¥) - ì´ë¯¸ì§€ ë¦¬ì‚¬ì´ì¦ˆ ë¡œì§ ì¶”ê°€
    async function saveData() { // ë¹„ë™ê¸° í•¨ìˆ˜ë¡œ ë³€ê²½
        try {
            const savedData = JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY) || '[]');

            let resizedMainImageDataUrl = '';
            const mainImageFile = companyMainImageInput.files[0];
            if (mainImageFile) {
                try {
                    // ì•ˆë‚´ë¬¸ ì´ë¯¸ì§€ ë¦¬ì‚¬ì´ì¦ˆ (ì˜ˆ: ìµœëŒ€ ë„ˆë¹„/ë†’ì´ 800px, í’ˆì§ˆ 0.7)
                    // ì €ì¥ ì‹œ ë¦¬ì‚¬ì´ì¦ˆ í¬ê¸°ë¥¼ ë¯¸ë¦¬ë³´ê¸°/ìº¡ì²˜ í¬ê¸°ì™€ ë‹¤ë¥´ê²Œ ì„¤ì •í•˜ì—¬ ìš©ëŸ‰ ì ˆê°
                    resizedMainImageDataUrl = await resizeImage(mainImageFile, 800, 800, 0.7);
                    console.log('Main image resized successfully for saving.');
                } catch (resizeError) {
                    console.error('Image resize failed for saving:', resizeError);
                    displayMessage('ì•ˆë‚´ë¬¸ ì´ë¯¸ì§€ ë¦¬ì‚¬ì´ì¦ˆì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ì›ë³¸ í¬ê¸°ë¡œ ì €ì¥ ì‹œ ìš©ëŸ‰ ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.', 'error');
                    // ë¦¬ì‚¬ì´ì¦ˆ ì‹¤íŒ¨ ì‹œ ì›ë³¸ Data URL ì‚¬ìš© (ìš©ëŸ‰ ë¬¸ì œ ë°œìƒ ê°€ëŠ¥)
                    const reader = new FileReader();
                     reader.onload = (e) => {
                         resizedMainImageDataUrl = e.target.result;
                          proceedSave(savedData, resizedMainImageDataUrl);
                     };
                     reader.onerror = (e) => {
                         console.error('Reading original image failed:', e);
                         displayMessage('ì›ë³¸ ì´ë¯¸ì§€ë¥¼ ì½ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë°ì´í„° ì €ì¥ì— ì‹¤íŒ¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.', 'error');
                         proceedSave(savedData, ''); // ì´ë¯¸ì§€ ì—†ì´ ì €ì¥ ì‹œë„
                     };
                     reader.readAsDataURL(mainImageFile);
                     return; // ë¹„ë™ê¸° ì²˜ë¦¬ë¥¼ ìœ„í•´ ì—¬ê¸°ì„œ í•¨ìˆ˜ ì¢…ë£Œ
                }
            }

            // ë¦¬ì‚¬ì´ì¦ˆê°€ ì„±ê³µí–ˆê±°ë‚˜ ì´ë¯¸ì§€ê°€ ì—†ëŠ” ê²½ìš° ì €ì¥ ì§„í–‰
            proceedSave(savedData, resizedMainImageDataUrl);

        } catch (e) {
            // JSON íŒŒì‹± ì˜¤ë¥˜ ë“± ì´ˆê¸° ì˜¤ë¥˜ ì²˜ë¦¬
            displayMessage('ë°ì´í„° ì €ì¥ ì¤€ë¹„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            console.error('Save data preparation error:', e);
        }
    }

    // ì‹¤ì œ ì €ì¥ ë¡œì§ì„ ë‹´ëŠ” í•¨ìˆ˜
    function proceedSave(savedData, mainImageDataUrl) {
         try {
             const currentData = {
                 applicantName: applicantNameInput.value,
                 teamName: teamNameInput.value,
                 interviewDate: interviewDateInput.value,
                 interviewLocation: interviewLocationInput.value,
                 interviewDressCode: interviewDressCodeInput.value,
                 interviewProcess: interviewProcessInput.value,
                 interviewProgress: interviewProgressInput.value,
                 additionalInfoType: additionalInfoTypeInput.value,
                 contactEmail: contactEmailInput.value,
                 factoryContactInfo: factoryContactInfoInput.value,
                 additionalInfoHtml: additionalInfoEditor.innerHTML, // ì—ë””í„° ë‚´ìš© ì €ì¥
                 companyLogoDataUrl: logoImagePreview.src === '#' ? '' : logoImagePreview.src, // ë¡œê³  Data URL ì €ì¥ (ë¦¬ì‚¬ì´ì¦ˆ ì—†ìŒ)
                 companyMainImageDataUrl: mainImageDataUrl // ë¦¬ì‚¬ì´ì¦ˆëœ ì•ˆë‚´ë¬¸ ì´ë¯¸ì§€ Data URL ì €ì¥
             };

             // ë°ì´í„° í¬ê¸° ì²´í¬
             const dataSize = JSON.stringify(currentData).length;
             const maxStorageSize = 5 * 1024 * 1024; // ì˜ˆ: 5MB

             if (dataSize > maxStorageSize) {
                  displayMessage('ì €ì¥í•˜ë ¤ëŠ” ë°ì´í„°ê°€ ë„ˆë¬´ í½ë‹ˆë‹¤. ì´ë¯¸ì§€ í¬ê¸°ë¥¼ ë” ì¤„ì´ê±°ë‚˜ ë°ì´í„° ì–‘ì„ ì¤„ì—¬ì£¼ì„¸ìš”.', 'error');
                  console.warn('Data size exceeds limit:', dataSize, 'bytes');
                  return; // ì €ì¥í•˜ì§€ ì•ŠìŒ
             }

             savedData.push(currentData); // ë°°ì—´ì— í˜„ì¬ ë°ì´í„° ì¶”ê°€
             localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(savedData));
             displaySavedData(); // ì €ì¥ í›„ ëª©ë¡ ì—…ë°ì´íŠ¸
             displayMessage('ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');

         } catch (e) {
             // QuotaExceededError ë“±ì„ í¬í•¨í•œ localStorage ì˜¤ë¥˜ ì²˜ë¦¬
             if (e.name === 'QuotaExceededError') {
                  displayMessage('ë°ì´í„° ì €ì¥ ê³µê°„ì´ ë¶€ì¡±í•©ë‹ˆë‹¤. ê¸°ì¡´ ë°ì´í„°ë¥¼ ì‚­ì œí•˜ê±°ë‚˜ ë¸Œë¼ìš°ì € ì„¤ì •ì„ í™•ì¸í•´ì£¼ì„¸ìš”.', 'error');
             } else {
                 displayMessage('ë°ì´í„° ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
             }
             console.error('Local storage save error:', e);
         }
    }


    // ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° í•¨ìˆ˜ (ëª©ë¡ì—ì„œ ì„ íƒí•˜ì—¬ ë¶ˆëŸ¬ì˜¤ê¸°)
    function loadData() {
        const selectedIndex = savedDataSelect.value;
        if (selectedIndex === "" || selectedIndex === null) { // null ì²´í¬ ì¶”ê°€
            displayMessage("ë¶ˆëŸ¬ì˜¬ ë°ì´í„°ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.", 'info');
            return;
        }

        try {
            const savedData = JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY) || '[]');
            const data = savedData[parseInt(selectedIndex)]; // ì„ íƒëœ ì¸ë±ìŠ¤ì˜ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°

            if (data) {
                applicantNameInput.value = data.applicantName || '';
                teamNameInput.value = data.teamName || '';
                interviewDateInput.value = data.interviewDate || '';
                interviewLocationInput.value = data.interviewLocation || '';
                interviewDressCodeInput.value = data.interviewDressCode || '';
                // ë¶ˆëŸ¬ì˜¬ ë•Œ ë“œë¡­ë‹¤ìš´ ê°’ ì„¤ì • ì‹œ í…ìŠ¤íŠ¸ê°€ ì•„ë‹Œ valueë¥¼ ì‚¬ìš©í•´ì•¼ í•¨
                // ì €ì¥ëœ ë°ì´í„°ì˜ interviewProcess ê°’("ì„œë¥˜ í•©ê²©")ì€ ê·¸ëŒ€ë¡œ ì‚¬ìš©
                interviewProcessInput.value = data.interviewProcess || 'ì„œë¥˜ í•©ê²©';
                interviewProgressInput.value = data.interviewProgress || '';
                additionalInfoTypeInput.value = data.additionalInfoType || 'ë‹´ë‹¹ì ë¬¸ì˜';
                contactEmailInput.value = data.contactEmail || '';
                factoryContactInfoInput.value = data.factoryContactInfo || '';
                additionalInfoEditor.innerHTML = data.additionalInfoHtml || ''; // ì—ë””í„° ë‚´ìš© ë¶ˆëŸ¬ì˜¤ê¸°

                // ë¡œê³  Data URL ë¶ˆëŸ¬ì˜¤ê¸°
                if (data.companyLogoDataUrl) {
                    logoImagePreview.src = data.companyLogoDataUrl;
                    logoImagePreview.style.display = 'block';
                } else {
                    logoImagePreview.style.display = 'none';
                    logoImagePreview.src = '#';
                }
                // ì•ˆë‚´ë¬¸ ì´ë¯¸ì§€ Data URL ë¶ˆëŸ¬ì˜¤ê¸°
                 if (data.companyMainImageDataUrl) {
                    mainImagePreview.src = data.companyMainImageDataUrl;
                    mainImagePreview.style.display = 'block';
                 } else {
                    mainImagePreview.style.display = 'none';
                    mainImagePreview.src = '#';
                 }


                updatePreview(); // ë¶ˆëŸ¬ì˜¨ ë°ì´í„°ë¡œ ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
                displayMessage('ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ë¶ˆëŸ¬ì™€ì¡ŒìŠµë‹ˆë‹¤.', 'success');
            } else {
                displayMessage('ì„ íƒëœ ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
            }
        } catch (e) {
            displayMessage('ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            console.error('Local storage load error:', e);
        }
    }

    // ë°ì´í„° ì‚­ì œ í•¨ìˆ˜ (ëª©ë¡ì—ì„œ ì„ íƒí•˜ì—¬ ì‚­ì œ)
    function deleteData() {
        const selectedIndex = savedDataSelect.value;
        if (selectedIndex === "" || selectedIndex === null) { // null ì²´í¬ ì¶”ê°€
            displayMessage("ì‚­ì œí•  ë°ì´í„°ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.", 'info');
            return;
        }

        if (confirm("ì„ íƒëœ ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
            try {
                let savedData = JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY) || '[]');
                savedData.splice(parseInt(selectedIndex), 1); // ì„ íƒëœ ì¸ë±ìŠ¤ì˜ ë°ì´í„° ì‚­ì œ
                localStorage.setItem(LOCAL_STORAGE_KEY, JSON.stringify(savedData));
                displaySavedData(); // ì‚­ì œ í›„ ëª©ë¡ ì—…ë°ì´íŠ¸
                clearForm(); // í¼ ì´ˆê¸°í™”
                displayMessage('ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
            } catch (e) {
                displayMessage('ë°ì´í„° ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                console.error('Local storage delete error:', e);
            }
        }
    }


    // ì €ì¥ëœ ë°ì´í„° ëª©ë¡ì„ ë“œë¡­ë‹¤ìš´ì— í‘œì‹œí•˜ëŠ” í•¨ìˆ˜
    function displaySavedData() {
        const savedData = JSON.parse(localStorage.getItem(LOCAL_STORAGE_KEY) || '[]');
        savedDataSelect.innerHTML = '<option value="">-- ì €ì¥ëœ ë°ì´í„° ì„ íƒ --</option>'; // ê¸°ì¡´ ì˜µì…˜ ì´ˆê¸°í™”

        if (savedData.length === 0) {
             const option = document.createElement('option');
             option.value = "";
             option.textContent = "-- ì €ì¥ëœ ë°ì´í„° ì—†ìŒ --";
             savedDataSelect.appendChild(option);
             loadDataButton.disabled = true; // ë°ì´í„° ì—†ìœ¼ë©´ ë¶ˆëŸ¬ì˜¤ê¸° ë²„íŠ¼ ë¹„í™œì„±í™”
             deleteDataButton.disabled = true; // ë°ì´í„° ì—†ìœ¼ë©´ ì‚­ì œ ë²„íŠ¼ ë¹„í™œì„±í™”
             return;
        }

        loadDataButton.disabled = false; // ë°ì´í„° ìˆìœ¼ë©´ ë²„íŠ¼ í™œì„±í™”
        deleteDataButton.disabled = false;


        savedData.forEach((data, index) => {
            const option = document.createElement('option');
            option.value = index; // ë°°ì—´ ì¸ë±ìŠ¤ë¥¼ ê°’ìœ¼ë¡œ ì‚¬ìš©
             // ë°ì´í„° ë ˆì´ë¸” ìƒì„± (ìˆœë²ˆ. ì´ë¦„ - ì ˆì°¨ (ë‚ ì§œ))
             // ë“œë¡­ë‹¤ìš´ ëª©ë¡ í‘œì‹œ ì‹œì—ëŠ” ì €ì¥ëœ valueê°€ ì•„ë‹Œ í‘œì‹œ í…ìŠ¤íŠ¸ë¥¼ ê°€ì ¸ì™€ì„œ ì‚¬ìš©
             // í˜„ì¬ ë“œë¡­ë‹¤ìš´ ì˜µì…˜ì—ì„œ í•´ë‹¹ valueë¥¼ ê°€ì§„ optionì˜ textContentë¥¼ ì°¾ìŒ
            const processOption = Array.from(interviewProcessInput.options).find(opt => opt.value === data.interviewProcess);
            const processText = processOption ? processOption.textContent : data.interviewProcess || 'ì ˆì°¨ ë¯¸ì •';

            const label = `${index + 1}. ${data.applicantName || 'ì´ë¦„ ì—†ìŒ'} - ${processText} (${data.interviewDate ? new Date(data.interviewDate).toLocaleDateString() : 'ë‚ ì§œ ë¯¸ì •'})`;
            option.textContent = label;
            savedDataSelect.appendChild(option);
        });
    }

     // í¼ ì…ë ¥ í•„ë“œ ë° ì—ë””í„° ë‚´ìš©ì„ ì´ˆê¸°í™”í•˜ëŠ” í•¨ìˆ˜
    function clearForm() {
        applicantNameInput.value = '';
        teamNameInput.value = '';
        interviewDateInput.value = '';
        interviewLocationInput.value = '';
        interviewDressCodeInput.value = '';
        interviewProcessInput.value = 'ì„œë¥˜ í•©ê²©'; // ì´ˆê¸°ê°’ì€ ë‚´ë¶€ value ì‚¬ìš©
        interviewProgressInput.value = '';
        additionalInfoTypeInput.value = 'ë‹´ë‹¹ì ë¬¸ì˜';
        contactEmailInput.value = '';
        factoryContactInfoInput.value = '';
        additionalInfoEditor.innerHTML = ''; // ì—ë””í„° ë‚´ìš© ì´ˆê¸°í™”

        // ì´ë¯¸ì§€ ì…ë ¥ í•„ë“œ ê°’ ì´ˆê¸°í™” (ë¯¸ë¦¬ë³´ê¸°ë§Œ ì´ˆê¸°í™”)
        companyLogoInput.value = ''; // íŒŒì¼ ì…ë ¥ í•„ë“œ ê°’ ì´ˆê¸°í™”
        companyMainImageInput.value = ''; // íŒŒì¼ ì…ë ¥ í•„ë“œ ê°’ ì´ˆê¸°í™”

        // ì´ë¯¸ì§€ ë¯¸ë¦¬ë³´ê¸° ì´ˆê¸°í™”
        logoImagePreview.style.display = 'none';
        logoImagePreview.src = '#';
        mainImagePreview.style.display = 'none';
        mainImagePreview.src = '#';


        updatePreview(); // ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
        displayMessage('ì…ë ¥ ë‚´ìš©ì´ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.', 'info'); // ì´ˆê¸°í™” ë©”ì‹œì§€ ì¶”ê°€
    }


    // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì—°ê²°
    applicantNameInput.addEventListener('input', updatePreview);
    teamNameInput.addEventListener('input', updatePreview);
    interviewProcessInput.addEventListener('change', updatePreview);
    interviewDateInput.addEventListener('change', updatePreview);
    interviewLocationInput.addEventListener('input', updatePreview);
    interviewDressCodeInput.addEventListener('input', updatePreview);
    interviewProgressInput.addEventListener('input', updatePreview);
    additionalInfoTypeInput.addEventListener('change', updatePreview);
    contactEmailInput.addEventListener('input', updateContactInfo);
    factoryContactInfoInput.addEventListener('input', updateContactInfo); // ë‹´ë‹¹ì ì •ë³´ ë³€ê²½ ì‹œ ê¸°íƒ€ ì‚¬í•­ ì—…ë°ì´íŠ¸
    additionalInfoEditor.addEventListener('input', updatePreview); // ì—ë””í„° ë‚´ìš© ë³€ê²½ ì‹œ ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
    companyLogoInput.addEventListener('change', updatePreview); // ë¡œê³  ì´ë¯¸ì§€ ë³€ê²½ ì‹œ ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
    companyMainImageInput.addEventListener('change', updatePreview); // ì•ˆë‚´ë¬¸ ì´ë¯¸ì§€ ë³€ê²½ ì‹œ ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸


    saveDataButton.addEventListener('click', saveData); // ì €ì¥ ë²„íŠ¼
    loadDataButton.addEventListener('click', loadData); // ë¶ˆëŸ¬ì˜¤ê¸° ë²„íŠ¼
    deleteDataButton.addEventListener('click', deleteData); // ì‚­ì œ ë²„íŠ¼
    resetFormButton.addEventListener('click', clearForm); // ì´ˆê¸°í™” ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì—°ê²°


    // ìº¡ì²˜ ë° ì €ì¥ ê¸°ëŠ¥
    captureAndSaveButton.addEventListener('click', () => {
        const teamName = applicantNameInput.value ? teamNameInput.value : 'ë¯¸ì •';
        const applicantName = applicantNameInput.value ? applicantNameInput.value : 'ì§€ì›ì';
        const interviewProcess = interviewProcessInput.value; // ë‚´ë¶€ value ì‚¬ìš©
        // íŒŒì¼ëª…ì— ì‚¬ìš©í•  ë•ŒëŠ” ë“œë¡­ë‹¤ìš´ì˜ í‘œì‹œ í…ìŠ¤íŠ¸ë¥¼ ê°€ì ¸ì™€ì„œ ì‚¬ìš©
        const interviewProcessText = interviewProcessInput.options[interviewProcessInput.selectedIndex].text;

        // ì €ì¥ í˜•ì‹ì€ PNGë¡œ ê³ ì •
        const selectedFormat = 'png';
        const fileExtension = 'png';

        const fileName = `${teamName}_${applicantName}_${interviewProcessText}.${fileExtension}`;


        // ìº¡ì²˜ ëŒ€ìƒ ìš”ì†Œ (basicTemplateDiv)ì˜ ë‚´ìš©ì„ ë³µì œí•˜ì—¬ ì„ì‹œ ì»¨í…Œì´ë„ˆì— ì‚½ì…
        const basicTemplateClone = basicTemplateDiv.cloneNode(true);
        captureContainer.innerHTML = ''; // ì„ì‹œ ì»¨í…Œì´ë„ˆ ë¹„ìš°ê¸°
        captureContainer.appendChild(basicTemplateClone); // ë³µì œëœ ë‚´ìš©ì„ ì‚½ì…

        // *** ìº¡ì²˜ ì‹œ ë ˆì´ì•„ì›ƒ ë¬¸ì œ í•´ê²°: ì¸ì‚¬ë§ ìš”ì†Œ ë’¤ì— <br><br> íƒœê·¸ ì¶”ê°€ ***
        const clonedGreeting = captureContainer.querySelector('#greeting');
        if(clonedGreeting) {
            // ê¸°ì¡´ ë‚´ìš© ë’¤ì— <br><br> íƒœê·¸ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
            clonedGreeting.innerHTML += '<br><br>';
        }
        // *******************************************************


        // ìº¡ì²˜ ì‹œ ì„¸ë¡œ ë ˆì´ì•„ì›ƒì„ ìœ„í•´ ì„ì‹œ ì»¨í…Œì´ë„ˆ ë„ˆë¹„ ê³ ì •
        const originalWidth = captureContainer.style.width;
        const originalHeight = captureContainer.style.height;
        const originalPosition = captureContainer.style.position;
        const originalTop = captureContainer.style.top;
        const originalLeft = captureContainer.style.left;
        const originalBorder = captureContainer.style.border;
        const originalBorderRadius = captureContainer.style.borderRadius;

        captureContainer.style.width = '600px'; // ì„¸ë¡œ ë ˆì´ì•„ì›ƒì„ ìœ„í•œ ë„ˆë¹„ (ì¡°ì • ê°€ëŠ¥)
        captureContainer.style.height = 'auto'; // ë†’ì´ëŠ” ë‚´ìš©ì— ë”°ë¼ ìë™ ì¡°ì ˆ
        captureContainer.style.position = 'static'; // ìº¡ì²˜ ì‹œ ì„ì‹œì ìœ¼ë¡œ ìœ„ì¹˜ë¥¼ ë³´ì´ê²Œ ì„¤ì •
        captureContainer.style.top = 'auto';
        captureContainer.style.left = 'auto';
        captureContainer.style.border = 'none'; // ìº¡ì²˜ ì‹œ í…Œë‘ë¦¬ ì œê±°
        captureContainer.style.borderRadius = '0'; // ìº¡ì²˜ ì‹œ ëª¨ì„œë¦¬ ë‘¥ê¸€ê¸° ì œê±°
        captureContainer.style.backgroundColor = '#ffffff'; // ë°°ê²½ìƒ‰ ê°•ì œ ì ìš©
        captureContainer.style.padding = '20px'; // íŒ¨ë”© ìœ ì§€
        captureContainer.style.boxSizing = 'border-box';


        // ì´ë¯¸ì§€ë¥¼ ì²¨ë¶€í•˜ì§€ ì•Šì•˜ì„ ê²½ìš°, í•´ë‹¹ ì´ë¯¸ì§€ ìš”ì†Œë¥¼ ì„ì‹œ ì»¨í…Œì´ë„ˆì—ì„œ ì œê±°
        if (!companyLogoInput.files[0]) {
            const logoPreviewDiv = captureContainer.querySelector('#companyLogoPreview');
            if (logoPreviewDiv) {
                logoPreviewDiv.remove();
            }
        }
        if (!companyMainImageInput.files[0]) {
            const mainImagePreviewDiv = captureContainer.querySelector('#companyMainImagePreviewArea');
            if (mainImagePreviewDiv) {
                mainImagePreviewDiv.remove();
            }
        }

        // ì„ì‹œ ì»¨í…Œì´ë„ˆ ë‚´ì˜ ëª¨ë“  ì´ë¯¸ì§€ ìš”ì†Œ ì°¾ê¸° (ìƒˆë¡œ ì‚½ì…ëœ ë‚´ìš© ê¸°ì¤€)
        const images = captureContainer.querySelectorAll('img');
        let imagesToLoad = images.length;

        // ì´ë¯¸ì§€ê°€ ì—†ê±°ë‚˜ ì´ë¯¸ ëª¨ë‘ ë¡œë“œëœ ê²½ìš° ë°”ë¡œ ìº¡ì²˜ ì‹¤í–‰
        if (imagesToLoad === 0 || Array.from(images).every(img => img.complete)) {
            console.log('All images loaded or no images found. Proceeding to capture.');
            performCapture(captureContainer, fileName, selectedFormat)
                .finally(() => { // ìº¡ì²˜ ì™„ë£Œ ë˜ëŠ” ì˜¤ë¥˜ ë°œìƒ ì‹œ ìŠ¤íƒ€ì¼ ë³µì›
                    captureContainer.style.width = originalWidth;
                    captureContainer.style.height = originalHeight;
                    captureContainer.style.position = originalPosition;
                    captureContainer.style.top = originalTop;
                    captureContainer.style.left = originalLeft;
                    captureContainer.style.border = originalBorder;
                    captureContainer.style.borderRadius = originalBorderRadius;
                    captureContainer.innerHTML = ''; // ì„ì‹œ ì»¨í…Œì´ë„ˆ ë‚´ìš© ë¹„ìš°ê¸°
                });
        } else {
            console.log(`Waiting for ${imagesToLoad} images to load before capturing.`);
            let loadedCount = 0;
            // ì´ë¯¸ì§€ ë¡œë”© ëŒ€ê¸°
            images.forEach(img => {
                // ì´ë¯¸ ë¡œë“œ ì™„ë£Œëœ ì´ë¯¸ì§€ëŠ” ì¹´ìš´íŠ¸ì—ì„œ ì œì™¸
                if (img.complete) {
                     imagesToLoad--;
                     console.log(`Image already complete. Remaining: ${imagesToLoad}`);
                     if (imagesToLoad === 0) {
                         console.log('All images loaded after check. Proceeding to capture.');
                         performCapture(captureContainer, fileName, selectedFormat)
                            .finally(() => { // ìº¡ì²˜ ì™„ë£Œ ë˜ëŠ” ì˜¤ë¥˜ ë°œìƒ ì‹œ ìŠ¤íƒ€ì¼ ë³µì›
                                captureContainer.style.width = originalWidth;
                                captureContainer.style.height = originalHeight;
                                captureContainer.style.position = originalPosition;
                                captureContainer.style.top = originalTop;
                                captureContainer.style.left = originalLeft;
                                captureContainer.style.border = originalBorder;
                                captureContainer.style.borderRadius = originalBorderRadius;
                                captureContainer.innerHTML = ''; // ì„ì‹œ ì»¨í…Œì´ë„ˆ ë‚´ìš© ë¹„ìš°ê¸°
                            });
                     }
                } else {
                    // ë¡œë“œ ë˜ëŠ” ì˜¤ë¥˜ ë°œìƒ ì‹œ ì¹´ìš´íŠ¸ ê°ì†Œ
                    img.onload = () => {
                        imagesToLoad--;
                        console.log(`Image loaded. Remaining: ${imagesToLoad}`);
                        if (imagesToLoad === 0) {
                            console.log('All images loaded via event. Proceeding to capture.');
                            performCapture(captureContainer, fileName, selectedFormat)
                                .finally(() => { // ìº¡ì²˜ ì™„ë£Œ ë˜ëŠ” ì˜¤ë¥˜ ë°œìƒ ì‹œ ìŠ¤íƒ€ì¼ ë³µì›
                                    captureContainer.style.width = originalWidth;
                                    captureContainer.style.height = originalHeight;
                                    captureContainer.style.position = originalPosition;
                                    captureContainer.style.top = originalTop;
                                    captureContainer.style.left = originalLeft;
                                    captureContainer.style.border = originalBorder;
                                    captureContainer.style.borderRadius = originalBorderRadius;
                                    captureContainer.innerHTML = ''; // ì„ì‹œ ì»¨í…Œì´ë„ˆ ë‚´ìš© ë¹„ìš°ê¸°
                                });
                        }
                    };
                     img.onerror = () => {
                        imagesToLoad--;
                         console.error(`Image failed to load. Remaining: ${imagesToLoad}`);
                         // ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨ ì‹œì—ë„ ìº¡ì²˜ ì§„í–‰ (ê¹¨ì§„ ì´ë¯¸ì§€ë¡œ ìº¡ì²˜ë  ìˆ˜ ìˆìŒ)
                        if (imagesToLoad === 0) {
                            console.log('Proceeding to capture despite image load error.');
                            performCapture(captureContainer, fileName, selectedFormat)
                                .finally(() => { // ìº¡ì²˜ ì™„ë£Œ ë˜ëŠ” ì˜¤ë¥˜ ë°œìƒ ì‹œ ìŠ¤íƒ€ì¼ ë³µì›
                                    captureContainer.style.width = originalWidth;
                                    captureContainer.style.height = originalHeight;
                                    captureContainer.style.position = originalPosition;
                                    captureContainer.style.top = originalTop;
                                    captureContainer.style.left = originalLeft;
                                    captureContainer.style.border = originalBorder;
                                    captureContainer.style.borderRadius = originalBorderRadius;
                                    captureContainer.innerHTML = ''; // ì„ì‹œ ì»¨í…Œì´ë„ˆ ë‚´ìš© ë¹„ìš°ê¸°
                                });
                        }
                     };
                }
            });
        }
    });

    // ìº¡ì²˜ ì‹¤í–‰ í•¨ìˆ˜ (ì´ì œ ì„ì‹œ ì»¨í…Œì´ë„ˆë¥¼ ëŒ€ìƒìœ¼ë¡œ í•¨) - í˜•ì‹ ì¸ì ì¶”ê°€
    function performCapture(elementToCapture, outputFileName, format = 'png') {
         console.log(`Performing capture in ${format} format...`);
         // ìº¡ì²˜ ì‹œì‘ ë©”ì‹œì§€ í‘œì‹œ
         displayMessage(`ì•ˆë‚´ë¬¸ ìº¡ì²˜ ì¤‘ (${format.toUpperCase()})...`, 'info');

         // PNG/JPEG ìº¡ì²˜ (dom-to-image)
         let capturePromise;
         if (format === 'jpeg') {
             // JPEG í˜•ì‹ì€ í’ˆì§ˆ ì„¤ì • ê°€ëŠ¥ (0 ~ 1, ê¸°ë³¸ê°’ì€ 0.92)
             capturePromise = domtoimage.toJpeg(elementToCapture, {
                 bgcolor: '#ffffff',
                 quality: 0.9 // í’ˆì§ˆ ì„¤ì •
             });
         } else { // ê¸°ë³¸ê°’ì€ png
             capturePromise = domtoimage.toPng(elementToCapture, {
                 bgcolor: '#ffffff'
             });
         }

         return capturePromise // Promiseë¥¼ ë°˜í™˜í•˜ì—¬ finally ì²´ì´ë‹ ê°€ëŠ¥í•˜ë„ë¡ ìˆ˜ì •
         .then(function (dataUrl) {
             console.log('Capture successful. Generating download link.');

             const link = document.createElement('a');
             link.href = dataUrl;
             link.download = outputFileName;
             link.click();

             // ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ
             displayMessage(`ì•ˆë‚´ë¬¸ì´ ì„±ê³µì ìœ¼ë¡œ ìº¡ì²˜ ë° ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤. (${format.toUpperCase()})`, 'success');

         })
         .catch(function (error) {
             console.error('ìº¡ì²˜ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:', error);
             // ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ
             displayMessage(`ì•ˆë‚´ë¬¸ ìº¡ì²˜ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. (${format.toUpperCase()}). ì½˜ì†”ì„ í™•ì¸í•´ì£¼ì„¸ìš”.`, 'error');
             throw error; // ì˜¤ë¥˜ë¥¼ ë‹¤ì‹œ throwí•˜ì—¬ finally ë¸”ë¡ì´ ì‹¤í–‰ë˜ë„ë¡ í•¨
         });
    }


    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸° ë°ì´í„° ëª©ë¡ í‘œì‹œ ë° ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸
    displaySavedData();
    updatePreview(); // Initial preview update

    // ë‹´ë‹¹ì ì •ë³´ ì…ë ¥ í•„ë“œ ë³€ê²½ ì‹œ ë¯¸ë¦¬ë³´ê¸° ì—…ë°ì´íŠ¸ í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë„ë¡ ìˆ˜ì •
     function updateContactInfo() {
         updatePreview();
     }
     contactEmailInput.addEventListener('input', updateContactInfo);
     factoryContactInfoInput.addEventListener('input', updateContactInfo);


    </script>
</body>
</html>
